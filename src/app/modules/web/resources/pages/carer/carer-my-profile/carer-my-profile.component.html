<app-care-home-booking-header
        navigationTitle="Back"
        navigationRoute="/carer-dashboard"
        mainTitle="Profile details"
></app-care-home-booking-header>
<br>
<div class="row">
    <div class="col-sm">
        <table [formGroup]="form" class="profile-table">
            <tr>
                <th class="tall">Your email address</th>
                <td class="tall relative">
                    <span class="first-row">{{ carerProfileService?.carerProfile?.email }}</span>
                    <span class="action">
                        <button (click)="showEditEmail = true" class="btn-success">Edit</button>
                    </span>
                    <span
                            *ngIf="!carerProfileService?.carerProfile?.email_verified"
                            (click)="onResendEmail()"
                            class="red second-row gj-cursor-pointer">
                        Not verified - tap to resend verification email
                    </span>
                </td>
            </tr>
            <tr>
                <th>Your Oliver James ID</th>
                <td>{{ carerProfileService?.carerProfile?._id }}</td>
            </tr>
            <tr>
                <th>Your phone number</th>
                <td><input formControlName="phone_number" type="text" class="form-control"></td>
            </tr>
            <tr>
                <th>Your First Name</th>
                <td>{{ carerProfileService?.carerProfile?.carer.first_name }}</td>
            </tr>
            <tr>
                <th>Middle Name</th>
                <td>{{ carerProfileService?.carerProfile?.carer?.middle_name }}</td>
            </tr>
            <tr>
                <th>Your Surname</th>
                <td>{{ carerProfileService?.carerProfile?.carer.surname }}</td>
            </tr>
            <tr>
                <th>Profile picture</th>
                <td class="relative tall">
                    <span class="action">
                        <button (click)="showChangeProfileImage = true" class="btn-success">Edit</button>
                    </span>
                </td>
            </tr>
            <tr>
                <th>Your address</th>
                <td>
                    <input
                            placeholder="Search for address"
                            autocorrect="off"
                            autocapitalize="off"
                            spellcheck="off"
                            type="text"
                            class="form-control"
                            id="searchControl" #search [formControl]="searchControl">
                </td>
            </tr>
            <tr>
                <th>Address line 1</th>
                <td><input formControlName="address_line_1" type="text" class="form-control"></td>
            </tr>
            <tr>
                <th>Address line 2</th>
                <td><input formControlName="address_line_2" type="text" class="form-control"></td>
            </tr>
            <tr>
                <th>City</th>
                <td><input formControlName="city" type="text" class="form-control"></td>
            </tr>
            <tr>
                <th>Postcode</th>
                <td><input formControlName="postal_code" type="text" class="form-control"></td>
            </tr>
            <tr>
                <th>Password</th>
                <td class="relative tall">
                    <span class="action">
                        <button (click)="showChangePassword = true" class="btn-success">Edit</button>
                    </span>
                </td>
            </tr>
            <tr>
                <th>Bank account details (to receive payment)</th>
                <td class="relative tall">
                    <span
                            *ngIf="carerProfileService?.carerProfile?.carer.payment_system.bank_number"
                            class="first-row"
                    >Account set up</span>
                    <span
                            *ngIf="!carerProfileService?.carerProfile?.carer.payment_system.bank_number"
                            class="first-row"
                    >Account not set up</span>
                    <span class="action">
                        <button (click)="showBankAccountForm = true" class="btn-success">Edit</button>
                    </span>
                </td>
            </tr>
            <tr>
                <th>Max job distance in miles</th>
                <td><input formControlName="max_job_distance" type="text" class="form-control"></td>
            </tr>
            <tr>
                <th>Eligible roles</th>
                <td>
                    <span
                            *ngFor="let role of carerProfileService?.carerProfile?.carer.eligible_roles"
                    >{{ role }}</span>
                     <span (click)="onRoleChange()" class="request">Request for change</span>
                </td>
            </tr>
        </table>
        <br>
        <button (click)="onUpdateProfile()" class="btn-success">Update profile</button>
    </div>
</div>

<app-change-email
        *ngIf="showEditEmail"
        (closed)="showEditEmail = false"
        (update)="onUpdateData()"
></app-change-email>

<app-change-password
        *ngIf="showChangePassword"
        (closed)="showChangePassword = false"
></app-change-password>

<app-change-profile-image
        *ngIf="showChangeProfileImage"
        [pictureUrl]="carerProfileService?.carerProfile?.carer.profile_image + '?access-token=' + authService.getAccessToken().token"
        (closed)="showChangeProfileImage = false"
        (update)="onUpdateData()"
></app-change-profile-image>

<app-card-details
    *ngIf="showBankAccountForm"
    (closed)="showBankAccountForm = false"
></app-card-details>